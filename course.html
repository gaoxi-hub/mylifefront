<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>徐州工程学院思政课学习管理系统</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css">
    <!--验证码css-->
    <link rel="stylesheet" href="css/verify.css">
    <link rel="stylesheet" href="css/common.css">

    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.cookie.js"></script>
    <script src="js/jquery.timers.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
</head>
<body>
<div class="navbar navbar-inverse" id="commonhead"></div>
<!--面包屑导航-->
<div class="container">
    <div class="row clearfix">
        <div class="col-md-12 column">
            <ul class="breadcrumb">
                <li>
                    <a href="index.html">主页</a>
                </li>
                <li class="active">
                    <a href="#">课程详情</a>
                </li>
            </ul>
        </div>
    </div>
</div>
<!--详细展示-->
<div class="container">
    <div class="row clearfix">
        <div class="col-md-12 column">
            <!--视频panel-->
            <div class="panel panel-warning" id="courseDetailHead">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        视频课程详情
                    </h3>
                </div>
                <div class="panel-body">
                    <div class="container">
                        <div class="row clearfix" >
                                    <div class="col-md-6 column">
                                        <img alt="140x140"  width="555" height="346.88"   v-bind:src="headInfo.courseImgUrl" />
                                    </div>
                                    <div class="col-md-6 column">
                                        <h3>
                                            {{headInfo.courseName}}
                                        </h3>
                                        <p>
                                            <span class="label label-info">观看人数:{{headInfo.learnNum}}</span>
                                            <span class="label-danger label">作者:{{headInfo.courseAuthor}}</span>
                                            <span class="label-warning label">{{ cctype}}</span>
                                        </p>
                                        <p>
                                             <h3 style="color: red" >{{ ccprice }}</h3>
                                        </p>
                                        <p style="height: 160px"></p>
                                        <button type="button" style="width: 180px" class="btn btn-default  btn-success btn-lg">{{  mylearn }}</button>
                                    </div>


                        </div>
                    </div>
                </div>
                <div class="panel-footer" v-show="headInfo.yourState!=0">
                    <h4>完成情况</h4>
                    <div class="progress progress-striped active">
                        <!--style 必须有-->
                        <div class="progress-bar progress-bar-success" role="progressbar"
                             aria-valuenow="56" aria-valuemin="0" aria-valuemax="100"
                             v-bind:style="{ width: cprocess + '%' }">
                            <span class="sr-only">{{cprocess}} %</span>
                        </div>
                    </div>
                </div>
            </div>



            <!--视频tab-->
            <div class="tabbable" id="tabs-185254">
                <ul class="nav nav-tabs">
                    <li class="active">
                        <a href="#panel-803260" data-toggle="tab">目录</a>
                    </li>
                </ul>
                <!--目录内容展示-->
                <div class="tab-content">
                    <div class="tab-pane active" id="panel-803260">
                        <div class="panel-group" id="panel-867161" >
                            <chapter-items v-for="(item,index) in courseChapters"  v-bind:cid="courseid" v-bind:pi="index"  v-bind:coursechapter="item"></chapter-items>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>




<!--页面底部-->

<footer class="white-wrapper">
</footer>

<!--登录注册模态框-->
<div class="modal fade" id="modal-container-912437" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
</div>



<script>
    $("#commonhead").load("head.html");
    $(".white-wrapper").load("foot.html");
    $("#modal-container-912437").load("login.html");
    //获取courseId
    var nowhref=window.location.href;
    //alert(nowhref);
    var courseId=nowhref.split('?')[1].split("=")[1];
    console.log("课程号为:"+courseId);
    var cTypeName=["","马原","思修","近代史","毛概"];
    $(function () {
        /*必须加上这一句不然tooltip无效果*/
        $("[data-toggle='tooltip']").tooltip();
        //课程详情头部内容
        var courseDetailHead = new Vue({
            el:'#courseDetailHead',
            data:{
                headInfo:{
                    courseImgUrl:"http://q4334xp0f.bkt.clouddn.com/20745CB8F35EF31164F6991276FF507F.jpg",
                    courseName:"毛泽东思想和中国特色社会主义理论体系概论",
                    courseAuthor:"高溪",
                    courseCType:4,
                    totalResNum:20,
                    learnNum:10,
                    courseType:0,
                    coursePrice:0,
                    yourState:0
                }
            },
            computed:{
              //计算课程价格
                ccprice:function(){
                  if(this.headInfo.courseType==0){
                      return "免费";
                  }else{
                      return this.headInfo.coursePrice;
                  }
              },
                //计算学习状态
               mylearn:function(){
                  if(this.headInfo.yourState==0){
                      return "加入学习";
                  }else{
                      return "正在学习";
                  }
               },
                //课程的类别
                cctype:function () {
                    return cTypeName[this.headInfo.courseCType];
                },
                //学习进度
                cprocess:function () {
                    return this.headInfo.learnNum/this.headInfo.totalResNum*100;
                }
            },
            created:function(){
                var user_token=$.cookie("user_token");
                if(user_token==undefined||user_token==''){
                    user_token="";
                }
                that=this;
                $.ajax({
                    url : "http://www.gaoxi.com/courses/getCourseHeadInfo",
                    type : "GET",
                    data:{"courseId":courseId,"userToken":user_token},
                  //  async: false,
                    success : function(res){

                        console.log(res.data);
                        that.headInfo=res.data;
                    },
                    error : function(){
                        console.log('请求失败');
                    }
                });
            },
            method:{
            }
        })

        //目录自定义组件
        Vue.component('chapter-items', {
            // video-item 组件现在接受一个
            // "prop"，类似于一个自定义特性。
            // 这个 prop 名为 videoinfo ,名字必须要小写
            props: ['coursechapter','pi','cid'],
            template:' <div class="panel panel-default">\n' +
            '                                <div class="panel-heading">\n' +
            '                                    <a class="panel-title collapsed" data-toggle="collapse" data-parent="#panel-867161" :href="`#panel-element-${pi}`">{{coursechapter.chapterName}}</a>\n' +
            '                                </div>\n' +
            '                                <div :id="`panel-element-${pi}`" class="panel-collapse collapse">\n' +
            '                                    <div class="panel-body">\n' +
            '                                        <ul class="list-group">\n' +
            '                                            <a  v-for="item in coursechapter.chapterRes"  :href="`http://www.gaoxi.com/playcourse.html?courseId=${cid}&videoId=${item.videoHref}`" class="list-group-item"><i class="fa fa-youtube-play" style="color:red"></i>&nbsp;{{item.videoName}}</a>\n' +
            '                                        </ul>\n' +
            '                                    </div>\n' +
            '                                </div>\n' +
            '                            </div>'
        })





        //章节内容
        var chapterContent = new Vue({
            el:"#panel-867161",
            data:{
                courseid:courseId,
                courseChapters:[
                    {
                        'chapterName':'我的帝国我做主',
                        chapterRes:[
                            {
                                videoName:'我的天空',
                                videoHref:'11'
                            },
                            {
                                videoName:'你的我的大家打',
                                videoHref:'https://www.baidu.com'
                            },{
                                videoName:'你是谁我要积极的学习',
                                videoHref:'https://www.gaoxicoj.com'
                            }
                        ]
                    },
                    {
                        'chapterName':'我的帝国我做主3',
                        chapterRes:[
                            {
                                videoName:'我的天空',
                                videoHref:'https://www.baidu.com'
                            },
                            {
                                videoName:'你的我的大家打',
                                videoHref:'https://www.baidu.com'
                            },{
                                videoName:'你是谁我要积极的学习',
                                videoHref:'https://www.gaoxicoj.com'
                            }
                        ]
                    },
                    {
                        'chapterName':'我的帝国我做主4',
                        chapterRes:[
                            {
                                videoName:'我的天空',
                                videoHref:'https://www.baidu.com'
                            },
                            {
                                videoName:'你的我的大家打',
                                videoHref:'https://www.baidu.com'
                            },{
                                videoName:'你是谁我要积极的学习',
                                videoHref:'https://www.gaoxicoj.com'
                            }
                        ]
                    },
                    {
                        'chapterName':'我的帝国我做主6',
                        chapterRes:[
                            {
                                videoName:'我的天空',
                                videoHref:'https://www.baidu.com'
                            },
                            {
                                videoName:'你的我的大家打',
                                videoHref:'https://www.baidu.com'
                            },{
                                videoName:'你是谁我要积极的学习',
                                videoHref:'https://www.gaoxicoj.com'
                            }
                        ]
                    }
                ]
            },
            created:function () {
                that=this;
                $.ajax({
                    url : "http://www.gaoxi.com/courses/getCourseChapterInfo",
                    type : "GET",
                    data:{"cId":courseId},
                    async:false,
                    success : function(res){
                        that.courseChapters=res.data;
                    },
                    error : function(){
                        console.log('请求失败');
                    }
                });
            }
        })
    });


</script>
</body>
</html>